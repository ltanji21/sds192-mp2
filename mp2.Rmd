---
title: "Mini-Project 2"
author: "Leigh Tanji & Samantha Bryce"
date: "October 31, 2017"
output: html_document
---


## Loading the data

This project is so interesting and relevant to my life!

I hope we can make this work

>>>>>>> 88b9ae9dda3e5db8b100c34ac26bccfcc4f30449
```{r, include=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r}
library(dplyr)
library(ggplot2)
```

```{r}
tbl_df(house_elections)
```

#How many incumbents won their elections? 
Saving this information for both parties as a dataframe.
```{r}
parties <- c("D", "R")

win_incumbs<- function(party_arg) {
house_elections %>%
  filter(incumbent == "TRUE" & party == party_arg) %>%
  group_by(state) %>%
  summarise(winners = sum(ge_winner == "W"))
}

wins <- lapply(parties, win_incumbs)

names(wins) <- c("win_dem", "win_rep")
list2env(wins, envir = .GlobalEnv)
```

#How many candidates were running for each party?
```{r}
total_candidates <- function(party_arg) {
  house_elections %>%
  filter(party == party_arg) %>%
  group_by(state) %>%
  summarise(N = n()) %>%
  data.frame()
}

total <- lapply(parties, total_candidates)

names(total) <- c("total_dem", "total_rep")
list2env(total, envir = .GlobalEnv)

tbl_df(total_dem)
tbl_df(total_rep)
```

Checking the 'total_incumbs' numbers from 'incumbs'. Should be 794 and 925. 
```{r}
total1 <- total_dem %>%
  summarise(SUM = sum(N))
total1

total2 <- total_rep %>%
  summarise(SUM = sum(N))
total2

total3 <- function(party_arg) {
  house_elections %>%
  filter(party == party_arg) %>%
  group_by(state) %>%
  select(state, party)
}

lapply(parties, total3)
```

Checking the 'winners_incumb' numbers from 'incumbs'. Should be 152 and 199.
```{r}
winners_incumbs1 <- win_dem %>%
  summarise(SUM= sum(winners))
winners_incumbs1

winners_incumbs2 <- win_rep %>%
  summarise(SUM = sum(winners))
winners_incumbs2

winners_incumbs3 <- function(party_arg) {
  house_elections %>%
  filter(incumbent == "TRUE" &  party == party_arg & ge_winner == "W") %>%
  group_by(state) %>%
  select(state, incumbent, ge_winner, party)
}

lapply(parties, winners_incumbs3)
```

#Percentage of winners. 
Calculating percentage of incumbent democratic winners to total democratic candidates. 
```{r}
percentage_dem <- total_dem %>%
  left_join(win_dem, by = "state") %>%
  mutate(percentage = winners*100/N) %>%
  select(state, percentage)

percentage_dem[is.na(percentage_dem)] <- 0
  
percentage_dem
```

Calculating percentage of incumbent republican winners to total republican candidates
```{r}
percentage_rep <- total_rep %>%
  left_join(win_rep, by = "state") %>%
  mutate(percentage = winners*100/N) %>%
  select(state, percentage)

percentage_rep[is.na(percentage_rep)] <- 0
  
percentage_rep
```
Combining republican percentage data to democratic data by state.
```{r}
percentage_parties <- percentage_dem %>%
  inner_join(percentage_rep, by = "state") %>%
  rename(Dem = percentage.x,
       Rep = percentage.y) %>%
  select(state, Dem, Rep)

list2env(percentage_parties, envir = .GlobalEnv)

percentage_parties
```

Number of democratic states that elected different percentages of incumbents.
```{r, error=FALSE, echo=FALSE}
Dem_states <- percentage_parties %>%
  filter(Dem > 0) %>%
  group_by(Percentage = cut(Dem, breaks = c(0.1, 20, 40, 60, 80, 100))) %>%
  summarise(state_no2 = n()) %>%
  ggplot(aes(x = Percentage, y = state_no2)) +
  geom_bar(stat = "identity") 
  

Dem_states
```

Number of Republican stats that elected different percenages of incumbents. 
```{r, error=FALSE, echo=FALSE}
Rep_states <- percentage_parties %>%
  filter(Dem > 0) %>%
  group_by(Percentage = cut(Rep, breaks = c(0.1, 20, 40, 60, 80, 100))) %>%
  summarise(state_no2 = n()) %>%
  ggplot(aes(x = Percentage, y = state_no2)) +
  geom_bar(stat = "identity") 
  

Rep_states
```




Making a scatterplot that compares dem to rep
```{r}
ggplot(percentage_parties, aes(y = Rep, x = Dem)) + 
  geom_text(label = state, position = "jitter", aes(angle = 45)) + xlab("Democratic candidates") + ylab("Republican candidates") + labs(title = "Percentage of incumbant candidates reelected by political party")
```

```{r}
ggplot(percentage_parties, aes(y = 0, x = Dem)) + geom_point(position = "jitter", colour = "blue", shape = 1, size = 2) + xlab("Democratic candidates") + labs(title = "Percentage of Democratic incumbant candidates reelected") + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) + scale_y_discrete(breaks=c("-0.1","0","0.1"))
```

```{r}
ggplot(percentage_parties, aes(y = 0, x = Rep)) + geom_point(position = "jitter", colour = "red", shape = 1, size = 2) + xlab("Republican candidates") + labs(title = "Percentage of Republican incumbant candidates reelected") + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) + scale_y_discrete(breaks=c("-0.1","0","0.1"))
```

Now let's put everything together







**Incumbent Candidates by Party: Why does the candidate I hate keep getting reelected?**

When you have a politician from the opposite party representing your state, it is easy to get annoyed when they continue to get reelected election after election. But do they actually get reelected more often than their peers from the opposite political party? Using data from the Federal Election Commission we explored whether or not incumbent candidates were more likely to get reelected in state elections based on which party they were running with.

So are these incumbent candidates getting reelected more often if they belong to one of the two major political parties in the United States? The answer is that it depends but overwhelmingly no. There are some outlier states that overwhelmingly reelect incumbent candidates from the dominant party of the state. Examples include South Dakota where 100% of incumbent Republican candidates and Maine where 100% of incumbent Democratic candidates were reelected. However, these are exceptions not norms. If you look below at Figure 1, which compares the percentage of Democratic and Republican incumbent candidates reelected by state you see that overwhelmingly there is very little variance based on party.


```{r, message=FALSE, echo=FALSE, warning=FALSE}
ggplot(percentage_parties, aes(y = Rep, x = Dem)) + 
  geom_text(label = state, position = "jitter", aes(angle = 45)) + xlab("Democratic candidates") + ylab("Republican candidates") + labs(title = "Percentage of incumbant candidates reelected by political party")
```
Figure 1: A comparison of the percentage of incumbent Democratic and Republican candidates running in states that got reelected

To better view this data we have also graphed the percentage of incumbent candidates that go reelected by party. In Figures 2 and 3 below, each point represents one state. When you compare the two figures you see that they are almost identical. Ultimately, in most cases it doesnâ€™t really matter which party you are running with when it comes to incumbent candidates getting reelected.

```{r, message=FALSE, echo=FALSE, warning=FALSE}
ggplot(percentage_parties, aes(y = 0, x = Dem)) + geom_point(position = "jitter", colour = "blue", shape = 1, size = 2) + xlab("Democratic candidates") + labs(title = "Percentage of Democratic incumbant candidates reelected") + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) + scale_y_discrete(breaks=c("-0.1","0","0.1"))
```
Figure 2: The percentage of incumbent Democratic candidates reelected by states

```{r, message=FALSE, echo=FALSE, warning=FALSE}
ggplot(percentage_parties, aes(y = 0, x = Rep)) + geom_point(position = "jitter", colour = "red", shape = 1, size = 2) + xlab("Republican candidates") + labs(title = "Percentage of Republican incumbant candidates reelected") + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) + scale_y_discrete(breaks=c("-0.1","0","0.1"))
```
Figure 3: The percentage of incumbent Republican candidates reelected by states






























